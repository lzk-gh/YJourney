import{c as j,a as le,y as ce,f as K,a3 as ue,a9 as re,aa as ve,a4 as fe,t as z,n as W,x as _,a1 as V,p as de,ab as I,v as D,w as L,s as he}from"./index-a3b8b258.js";import{g as U,r as me,t as q,j as d,w as S,k as F,l as ge,e as we,f as pe,h as C,n as G}from"./index-ab6fab78.js";const[J,M]=j("swipe"),ye={loop:z,width:W,height:W,vertical:Boolean,autoplay:_(0),duration:_(500),touchable:z,lazyRender:Boolean,initialSwipe:_(0),indicatorColor:String,showIndicators:z,stopPropagation:z},Q=Symbol(J);var be=U({name:J,props:ye,emits:["change"],setup(a,{emit:P,slots:h}){const u=me(),e=q({rect:null,width:0,height:0,offset:0,active:0,swiping:!1}),l=le(),{children:m,linkChildren:k}=ce(Q),i=d(()=>m.length),n=d(()=>e[a.vertical?"height":"width"]),r=d(()=>a.vertical?l.deltaY.value:l.deltaX.value),f=d(()=>e.rect?(a.vertical?e.rect.height:e.rect.width)-n.value*i.value:0),$=d(()=>Math.ceil(Math.abs(f.value)/n.value)),y=d(()=>i.value*n.value),w=d(()=>(e.active+i.value)%i.value),R=d(()=>{const t=a.vertical?"vertical":"horizontal";return l.direction.value===t}),Z=d(()=>{const t={transitionDuration:`${e.swiping?0:a.duration}ms`,transform:`translate${a.vertical?"Y":"X"}(${e.offset}px)`};if(n.value){const s=a.vertical?"height":"width",o=a.vertical?"width":"height";t[s]=`${y.value}px`,t[o]=a[o]?`${a[o]}px`:""}return t}),ee=t=>{const{active:s}=e;return t?a.loop?D(s+t,-1,i.value):D(s+t,0,$.value):s},B=(t,s=0)=>{let o=t*n.value;a.loop||(o=Math.min(o,-f.value));let v=s-o;return a.loop||(v=D(v,f.value,0)),v},g=({pace:t=0,offset:s=0,emitChange:o})=>{if(i.value<=1)return;const{active:v}=e,c=ee(t),T=B(c,s);if(a.loop){if(m[0]&&T!==f.value){const O=T<f.value;m[0].setOffset(O?y.value:0)}if(m[i.value-1]&&T!==0){const O=T>0;m[i.value-1].setOffset(O?-y.value:0)}}e.active=c,e.offset=T,o&&c!==v&&P("change",w.value)},A=()=>{e.swiping=!0,e.active<=-1?g({pace:i.value}):e.active>=i.value&&g({pace:-i.value})},te=()=>{A(),l.reset(),I(()=>{e.swiping=!1,g({pace:-1,emitChange:!0})})},E=()=>{A(),l.reset(),I(()=>{e.swiping=!1,g({pace:1,emitChange:!0})})};let Y;const b=()=>clearTimeout(Y),x=()=>{b(),a.autoplay>0&&i.value>1&&(Y=setTimeout(()=>{E(),x()},+a.autoplay))},p=(t=+a.initialSwipe)=>{if(!u.value)return;const s=()=>{var o,v;if(!V(u)){const c={width:u.value.offsetWidth,height:u.value.offsetHeight};e.rect=c,e.width=+((o=a.width)!=null?o:c.width),e.height=+((v=a.height)!=null?v:c.height)}i.value&&(t=Math.min(i.value-1,t)),e.active=t,e.swiping=!0,e.offset=B(t),m.forEach(c=>{c.setOffset(0)}),x()};V(u)?G().then(s):s()},X=()=>p(e.active);let H;const ae=t=>{a.touchable&&(l.start(t),H=Date.now(),b(),A())},ie=t=>{a.touchable&&e.swiping&&(l.move(t),R.value&&(de(t,a.stopPropagation),g({offset:r.value})))},N=()=>{if(!a.touchable||!e.swiping)return;const t=Date.now()-H,s=r.value/t;if((Math.abs(s)>.25||Math.abs(r.value)>n.value/2)&&R.value){const v=a.vertical?l.offsetY.value:l.offsetX.value;let c=0;a.loop?c=v>0?r.value>0?-1:1:0:c=-Math[r.value>0?"ceil":"floor"](r.value/n.value),g({pace:c,emitChange:!0})}else r.value&&g({pace:0});e.swiping=!1,x()},ne=(t,s={})=>{A(),l.reset(),I(()=>{let o;a.loop&&t===i.value?o=e.active===0?0:t:o=t%i.value,s.immediate?I(()=>{e.swiping=!1}):e.swiping=!1,g({pace:o-e.active,emitChange:!0})})},oe=(t,s)=>{const o=s===w.value,v=o?{backgroundColor:a.indicatorColor}:void 0;return C("i",{style:v,class:M("indicator",{active:o})},null)},se=()=>{if(h.indicator)return h.indicator({active:w.value,total:i.value});if(a.showIndicators&&i.value>1)return C("div",{class:M("indicators",{vertical:a.vertical})},[Array(i.value).fill("").map(oe)])};return K({prev:te,next:E,state:e,resize:X,swipeTo:ne}),k({size:n,props:a,count:i,activeIndicator:w}),S(()=>a.initialSwipe,t=>p(+t)),S(i,()=>p(e.active)),S(()=>a.autoplay,x),S([ue,re],X),S(ve(),t=>{t==="visible"?x():b()}),F(p),ge(()=>p(e.active)),fe(()=>p(e.active)),we(b),pe(b),()=>{var t;return C("div",{ref:u,class:M()},[C("div",{style:Z.value,class:M("track",{vertical:a.vertical}),onTouchstart:ae,onTouchmove:ie,onTouchend:N,onTouchcancel:N},[(t=h.default)==null?void 0:t.call(h)]),se()])}}});const $e=L(be),[xe,Te]=j("swipe-item");var Se=U({name:xe,setup(a,{slots:P}){let h;const u=q({offset:0,inited:!1,mounted:!1}),{parent:e,index:l}=he(Q);if(!e)return;const m=d(()=>{const n={},{vertical:r}=e.props;return e.size.value&&(n[r?"height":"width"]=`${e.size.value}px`),u.offset&&(n.transform=`translate${r?"Y":"X"}(${u.offset}px)`),n}),k=d(()=>{const{loop:n,lazyRender:r}=e.props;if(!r||h)return!0;if(!u.mounted)return!1;const f=e.activeIndicator.value,$=e.count.value-1,y=f===0&&n?$:f-1,w=f===$&&n?0:f+1;return h=l.value===f||l.value===y||l.value===w,h}),i=n=>{u.offset=n};return F(()=>{G(()=>{u.mounted=!0})}),K({setOffset:i}),()=>{var n;return C("div",{class:Te(),style:m.value},[k.value?(n=P.default)==null?void 0:n.call(P):null])}}});const Ae=L(Se);export{$e as S,Ae as a};
